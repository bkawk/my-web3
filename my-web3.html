<link rel="import" href="../polymer/polymer.html">

<!--
`my-web3`


@demo demo/index.html
-->

<dom-module id="my-web3">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    
    <template is="dom-if" if={{isEnabled}}>
      <load-web3 
        web3Obj="{{web3Obj}}">
      </load-web3>   
    </template>
  ---{{web3Obj}}---
  </template>



  <script>
    class MyElement extends Polymer.Element {
      static get is() { return 'my-web3'; }
      static get properties() {
        return {
          isEnabled: {
            type: Boolean,
            value: false,
          },
          web3Obj:{
            type: Object,
            observer: '_pageChanged',
          }
        };
      }

      connectedCallback(){
        super.connectedCallback();
        if (typeof web3 !== 'undefined') {
          this._loaded();
        } else {
          this._load();
        }
      }

      _load(){
        console.log('Load')
        var resolvedPageUrl = this.resolveUrl('load-web3.html');
        Polymer.importHref(
          resolvedPageUrl,
          null,
          this._loaded(),
          true);
      }
      _loaded() {
        console.log('Loaded')
        this.isEnabled = true;
      }
      _pageChanged(){
        console.log('Finished')
        console.log(this.web3Obj)
      }

  } window.customElements.define(MyElement.is, MyElement);
  </script>

</dom-module>
